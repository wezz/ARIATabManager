(function(o,r){typeof exports=="object"&&typeof module<"u"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(o=typeof globalThis<"u"?globalThis:o||self,r(o.ariatabmanager={}))})(this,function(o){"use strict";var A=Object.defineProperty;var m=(o,r,c)=>r in o?A(o,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[r]=c;var d=(o,r,c)=>(m(o,typeof r!="symbol"?r+"":r,c),c);var r=Object.defineProperty,c=(l,t,e)=>t in l?r(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e,g=(l,t,e)=>(c(l,typeof t!="symbol"?t+"":t,e),e);class f{constructor(t=document.body){g(this,"controlelements",[]),g(this,"controlselector","[aria-controls]:not([data-ariamanager-ignore])"),g(this,"delayAttribute","data-ariamanager-delay"),this.InitiateElements(t),window.addEventListener("global-markupchange",e=>{var a;this.InitiateElements(((a=e==null?void 0:e.detail)==null?void 0:a.target)??document)})}InitiateElements(t=document.body){const e=[].slice.call(t.querySelectorAll(this.controlselector)).filter(a=>a.dataset.ariamanager!=="activated");e.forEach(a=>{this.bindEvents(a),a.dataset.ariamanager="activated"}),this.controlelements=[].concat(this.controlelements,e)}AriaExpand(t,e){t&&(this.bindEventsToTargetElements(t),t.dispatchEvent(this.customEvent("set-aria-expanded",{target:t,value:e})))}AriaHidden(t,e){t&&(this.bindEventsToTargetElements(t),t.dispatchEvent(this.customEvent("set-aria-hidden",{target:t,value:e})))}GetARIAControllerFromTarget(t){const e=t.getAttribute("id")+"";return e?this.controlelements.filter(a=>(a.getAttribute("aria-controls")+"").indexOf(e)!==-1):[]}GetARIAControlTargets(t){const e=(t.getAttribute("aria-controls")+"").split(" "),a=[],n=(i,s)=>i.indexOf(s)===0;return e.forEach(i=>{i=(!n(i,"#")&&!n(i,".")?"#":"")+i;const s=document.querySelector(i);s&&a.push(s)}),a}onButtonClick(t){const e=this.getDelayValue(t);t.dispatchEvent(this.customEvent("beforeClick",{delay:e,elm:t})),window.setTimeout(()=>{t.dispatchEvent(this.customEvent("adjustTargetStates",{elm:t}))},e)}bindEvents(t){const e=t;this.bindEventsToControlElements(e),this.GetARIAControlTargets(e).forEach(a=>{this.bindEventsToTargetElements(a)})}bindEventsToTargetElements(t){t.dataset.ariamanager_eventbindings!=="true"&&(t.addEventListener("set-aria-hidden",this.setAriaHidden.bind(this)),t.addEventListener("set-aria-expanded",this.setAriaExpanded.bind(this)),t.dataset.ariamanager_eventbindings="true")}bindEventsToControlElements(t){t.addEventListener("click",this.onButtonClick.bind(this,t)),t.addEventListener("beforeClick",this.beforeClickEvent.bind(this,t)),t.addEventListener("adjustTargetStates",this.adjustTargetStates.bind(this,t)),t.addEventListener("updateButtonState",this.updateButtonState.bind(this,t))}updateButtonState(t,e){const a=(s,h)=>s.hasAttribute(h)?s.getAttribute(h):null,n=e.detail.target,i=a(n,"aria-hidden");t.hasAttribute("aria-pressed")&&t.setAttribute("aria-pressed",(i==="false")+""),t.hasAttribute("aria-expanded")&&t.setAttribute("aria-expanded",(i==="false")+"")}setAriaHidden(t){const e=t.detail.target,a=t.detail.value,n=this.GetARIAControllerFromTarget(e);e.setAttribute("aria-hidden",a),e.dispatchEvent(this.customEvent("aria-hidden-change",{target:e,value:a})),n.forEach(i=>{i.dispatchEvent(this.customEvent("updateButtonState",{target:e}))})}setAriaExpanded(t){const e=t.detail.target,a=t.detail.value,n=this.GetARIAControllerFromTarget(e);e.hasAttribute("data-aria-expanded")&&e.setAttribute("data-aria-expanded",a+""),e.dispatchEvent(this.customEvent("aria-expanded-change",{target:e,value:a})),n.forEach(i=>{i.dispatchEvent(this.customEvent("updateButtonState",{target:e}))})}beforeClickEvent(t,e){}adjustTargetStates(t,e){this.GetARIAControlTargets(t).forEach(a=>{if(a.hasAttribute("aria-hidden")){const n=a.getAttribute("aria-hidden")==="true";this.AriaHidden(a,!n)}if(t.hasAttribute("aria-expanded")||a.hasAttribute("data-aria-expanded")){const n=a.getAttribute("aria-hidden")==="true";this.AriaExpand(a,!n)}})}getDelayValue(t){let e=0;const a=t.getAttribute(this.delayAttribute);if(typeof a=="string"&&a.length>0){const n=parseInt(a,10);isNaN(n)||(e=n)}return e}customEvent(t,e){return new CustomEvent(t,{detail:e})}}const u=new f(document.body);class b{}d(b,"AllowNone","allownone"),d(b,"Default","");class E{constructor(){d(this,"controlelements",[]);d(this,"controlselector","[data-tab-container]");d(this,"contentselector","[data-tab-content]");d(this,"contentcontainerselector","[data-tab-contentcontainer]");d(this,"buttonselector","[data-tab-button]");d(this,"tabmodeattributename","data-tab-selection-mode");d(this,"defaultDelay",0);this.InitiateElements(),this.checkPageHash()}InitiateElements(){const e=[].slice.call(document.querySelectorAll(this.controlselector)).filter(a=>a.dataset.tabmanager!=="activated");e.forEach(this.initiateElement.bind(this)),e.forEach(a=>a.dataset.tabmanager="activated"),this.controlelements=[].concat(this.controlelements,e)}initiateElement(t){this.setDefaultDelay(t),t.getAttribute("data-tab-setheight")==="true"&&(this.setContentHeight(t),window.setInterval(()=>{this.setContentHeight(t)},1e3)),this.bindEvents(t)}setDefaultDelay(t){const e=t.getAttribute(this.controlselector);let a=this.defaultDelay;if(typeof e=="string"&&e.length>0){const n=parseInt(e,10);isNaN(n)||(a=n)}t.dataset.tabanimationdelay=a+""}bindEvents(t){const e=t;this.getButtons(e).forEach(n=>{n.addEventListener("beforeClick",this.onBeforeClick.bind(this,e,n))})}async onBeforeClick(t,e){const a=await u.GetARIAControlTargets(e),n=t.getAttribute(this.tabmodeattributename),i=a[0].id;this.getTargets(t).filter(h=>h.id!==i).forEach(h=>{u.AriaHidden(h,!0),u.AriaExpand(h,!1)}),this.setPageHash(e),this.setContentHeight(t),n!==b.AllowNone&&this.displayTarget(a[0],t)}setPageHash(t){if(t.hasAttribute("data-tab-href")){const e=t.getAttribute("data-tab-href");if(!e)return;history&&typeof history.replaceState=="function"?history.replaceState({},"",e):window.location.hash=e}}checkPageHash(){const t=(window.location.hash+"").split(",").filter(e=>e);t.length!==0&&t.forEach(e=>{const a=Array.from(document.querySelectorAll('[data-tab-href="'+e+'"]'));a&&a.length>0&&a.forEach(n=>{const i=this.getTabContainer(n);i&&this.onBeforeClick(i,n)})})}getTabContainer(t){let e=t.parentNode;for(;!(e.matches("body")||e.hasAttribute("data-tab-container"));)e=e.parentNode;return e.matches("body")?null:e}displayTarget(t,e,a=180){window.setTimeout(()=>{const n=this.getTargets(e);n.filter(s=>s.getAttribute("aria-hidden")==="true").length===n.length&&(u.AriaHidden(t,!1),u.AriaExpand(t,!0))},a)}getTargets(t){return[].slice.call(t.querySelectorAll(this.contentselector))}getButtons(t){return[].slice.call(t.querySelectorAll(this.buttonselector))}setContentHeight(t){const e=t.querySelector(this.contentcontainerselector);if(e&&t.getAttribute("data-tab-setheight")==="true"){const a=this.getTargets(t);let n=0;if(a.forEach(i=>{const s=i.getClientRects()[0];s&&s.height>n&&(n=s.height)}),n>0){const i="height:"+n+"px";e.setAttribute("style",i)}}}}o.ARIATabManager=E,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
